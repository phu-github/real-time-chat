{"ast":null,"code":"import _regeneratorRuntime from\"D:/Project Reactjs/Real-time/real-time-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Project Reactjs/Real-time/real-time-chat/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import{Row,Col,Button,Typography}from'antd';import firebase,{auth,db}from'../../firebase/config';import{useHistory}from\"react-router\";import{addDocument}from'../../firebase/services';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Title=Typography.Title;var fbProvider=new firebase.auth.FacebookAuthProvider();export default function Login(){var history=useHistory();console.log(history);// Nhấn nút đăng nhập bằng Facebook\nvar handleFbLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$auth$signInWit,additionalUserInfo,user;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return auth.signInWithPopup(new firebase.auth.FacebookAuthProvider());case 2:_yield$auth$signInWit=_context.sent;additionalUserInfo=_yield$auth$signInWit.additionalUserInfo;user=_yield$auth$signInWit.user;// Nếu là người đăng nhập mới thì add dữ liệu vào  store database\nconsole.log(\"additionalUserInfo\",additionalUserInfo);console.log(\"user\",user);if(additionalUserInfo===null||additionalUserInfo===void 0?void 0:additionalUserInfo.isNewUser){// db.collection('users').add({\n//     displayName: user.displayName,\n//     email: user.email,\n//     photoURL: user.photoURL,\n//     uid: user.displayName,\n//     providerId: additionalUserInfo.providerId\n// })\n// console.log('chạy ổn mà');\naddDocument('users',{displayName:user.displayName,email:user.email,photoURL:user.photoURL,uid:user.displayName,providerId:additionalUserInfo.providerId});}case 8:case\"end\":return _context.stop();}}},_callee);}));return function handleFbLogin(){return _ref.apply(this,arguments);};}();auth.onAuthStateChanged(function(user){console.log({user:user});// nếu login thành công sẽ chuyển hướng đến trang khác\nif(user){history.push(\"/\");}});return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Title,{level:3,children:\"Chat for fun\"}),/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Button,{children:\"\\u0110\\u0103ng nh\\u1EADp b\\u1EB1ng GOOGLE\"})}),/*#__PURE__*/_jsxs(Col,{children:[/*#__PURE__*/_jsx(Title,{}),/*#__PURE__*/_jsx(Button,{onClick:handleFbLogin,children:\"\\u0110\\u0103ng nh\\u1EADp b\\u1EB1ng FACEBOOK\"})]})]})});}","map":{"version":3,"sources":["D:/Project Reactjs/Real-time/real-time-chat/src/components/Login/index.jsx"],"names":["React","Row","Col","Button","Typography","firebase","auth","db","useHistory","addDocument","Title","fbProvider","FacebookAuthProvider","Login","history","console","log","handleFbLogin","signInWithPopup","additionalUserInfo","user","isNewUser","displayName","email","photoURL","uid","providerId","onAuthStateChanged","push"],"mappings":"iUAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,GAAT,CAAcC,GAAd,CAAmBC,MAAnB,CAA2BC,UAA3B,KAA6C,MAA7C,CACA,MAAOC,CAAAA,QAAP,EAAmBC,IAAnB,CAAyBC,EAAzB,KAAmC,uBAAnC,CACA,OAASC,UAAT,KAA2B,cAA3B,CACA,OAAQC,WAAR,KAA0B,yBAA1B,C,wFAEA,GAAOC,CAAAA,KAAP,CAAgBN,UAAhB,CAAOM,KAAP,CACA,GAAMC,CAAAA,UAAU,CAAG,GAAIN,CAAAA,QAAQ,CAACC,IAAT,CAAcM,oBAAlB,EAAnB,CAEA,cAAe,SAASC,CAAAA,KAAT,EAAiB,CAC5B,GAAIC,CAAAA,OAAO,CAAGN,UAAU,EAAxB,CACAO,OAAO,CAACC,GAAR,CAAYF,OAAZ,EAEA;AACA,GAAMG,CAAAA,aAAa,0FAAG,2MACuBX,CAAAA,IAAI,CAACY,eAAL,CAAqB,GAAIb,CAAAA,QAAQ,CAACC,IAAT,CAAcM,oBAAlB,EAArB,CADvB,4CACXO,kBADW,uBACXA,kBADW,CACSC,IADT,uBACSA,IADT,CAElB;AACAL,OAAO,CAACC,GAAR,CAAY,oBAAZ,CAAkCG,kBAAlC,EACAJ,OAAO,CAACC,GAAR,CAAY,MAAZ,CAAoBI,IAApB,EACA,GAAGD,kBAAH,SAAGA,kBAAH,iBAAGA,kBAAkB,CAAEE,SAAvB,CAAiC,CAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAZ,WAAW,CACP,OADO,CAEP,CACIa,WAAW,CAAEF,IAAI,CAACE,WADtB,CAEIC,KAAK,CAAEH,IAAI,CAACG,KAFhB,CAGIC,QAAQ,CAAEJ,IAAI,CAACI,QAHnB,CAIIC,GAAG,CAAEL,IAAI,CAACE,WAJd,CAKII,UAAU,CAAEP,kBAAkB,CAACO,UALnC,CAFO,CAAX,CAYH,CA1BiB,sDAAH,kBAAbT,CAAAA,aAAa,0CAAnB,CA4BAX,IAAI,CAACqB,kBAAL,CAAwB,SAACP,IAAD,CAAS,CAC7BL,OAAO,CAACC,GAAR,CAAY,CAACI,IAAI,CAAJA,IAAD,CAAZ,EAEA;AACA,GAAGA,IAAH,CAAQ,CACJN,OAAO,CAACc,IAAR,CAAa,GAAb,EACH,CACJ,CAPD,EAQA,mBACI,kCACI,MAAC,GAAD,yBACI,KAAC,KAAD,EAAO,KAAK,CAAE,CAAd,0BADJ,cAEI,KAAC,GAAD,EAAK,IAAI,CAAE,CAAX,uBACI,KAAC,MAAD,wDADJ,EAFJ,cAKI,MAAC,GAAD,yBACI,KAAC,KAAD,IADJ,cAEI,KAAC,MAAD,EAAQ,OAAO,CAAEX,aAAjB,yDAFJ,GALJ,GADJ,EADJ,CAcH","sourcesContent":["import React from 'react';\r\nimport { Row, Col, Button, Typography } from 'antd';\r\nimport firebase, { auth, db } from '../../firebase/config';\r\nimport { useHistory } from \"react-router\";\r\nimport {addDocument} from '../../firebase/services';\r\n\r\nconst {Title} = Typography;\r\nconst fbProvider = new firebase.auth.FacebookAuthProvider();\r\n\r\nexport default function Login() {\r\n    let history = useHistory();\r\n    console.log(history);\r\n\r\n    // Nhấn nút đăng nhập bằng Facebook\r\n    const handleFbLogin = async () =>{\r\n        const {additionalUserInfo, user} = await auth.signInWithPopup(new firebase.auth.FacebookAuthProvider()); \r\n        // Nếu là người đăng nhập mới thì add dữ liệu vào  store database\r\n        console.log(\"additionalUserInfo\", additionalUserInfo);\r\n        console.log(\"user\", user);\r\n        if(additionalUserInfo?.isNewUser){\r\n            // db.collection('users').add({\r\n            //     displayName: user.displayName,\r\n            //     email: user.email,\r\n            //     photoURL: user.photoURL,\r\n            //     uid: user.displayName,\r\n            //     providerId: additionalUserInfo.providerId\r\n            // })\r\n            // console.log('chạy ổn mà');\r\n            addDocument(\r\n                'users', \r\n                {\r\n                    displayName: user.displayName,\r\n                    email: user.email,\r\n                    photoURL: user.photoURL,\r\n                    uid: user.displayName,\r\n                    providerId: additionalUserInfo.providerId\r\n                }\r\n            )\r\n\r\n\r\n        }\r\n    };\r\n    auth.onAuthStateChanged((user) =>{\r\n        console.log({user});\r\n\r\n        // nếu login thành công sẽ chuyển hướng đến trang khác\r\n        if(user){\r\n            history.push(\"/\");\r\n        }\r\n    });\r\n    return (\r\n        <div>\r\n            <Row >\r\n                <Title level={3}>Chat for fun</Title>\r\n                <Col span={8}>\r\n                    <Button>Đăng nhập bằng GOOGLE</Button>\r\n                </Col>\r\n                <Col>\r\n                    <Title></Title>\r\n                    <Button onClick={handleFbLogin}>Đăng nhập bằng FACEBOOK</Button>\r\n                </Col>\r\n            </Row>\r\n        </div>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}